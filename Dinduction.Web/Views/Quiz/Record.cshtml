@model Dinduction.Web.Models.MasterTrainingVM
@using Dinduction.Domain.Entities
@{
    var status = TempData["QuizStatus"] as string ?? "Start";
    var questionCount = Convert.ToInt32(TempData["QuestionCount"] ?? 0);
    var participantId = Convert.ToInt32(TempData["ParticipantId"] ?? 0);
    var pointPerQuestion = questionCount == 5 ? 20 : 10;
}

<div class="mobile-container">
    @using (Html.BeginForm("Training", "User", FormMethod.Post, new { id = "trainingForm" }))
    {
        @Html.AntiForgeryToken()
        
        <!-- Header Section -->
        <div class="header-card">
            <h1 class="title">@Model.TrainingName</h1>
            <div class="subtitle">@Model.EvaluationForm</div>
            <div class="meta-info">
                <span class="form-code">@Model.FormNumberRegistration</span>
                <span class="separator">•</span>
                <span class="date">@(Model.FormDateRegistration?.ToString("dd MMM yyyy") ?? "")</span>
            </div>
        </div>

        <!-- Objectives Section - Compact -->
        <div class="section-card">
            <h2 class="section-title">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
                </svg>
                Tujuan Penilaian / Objectives
            </h2>
            <ol class="objectives-list">
                <li>
                    <div class="obj-id">@Model.Purpose1</div>
                    <div class="obj-en">@Model.PurposeEnglish1</div>
                </li>
                <li>
                    <div class="obj-id">@Model.Purpose2</div>
                    <div class="obj-en">@Model.PurposeEnglish2</div>
                </li>
            </ol>
        </div>

        <!-- Scoring System - Compact & Visual -->
        <div class="section-card scoring-card">
            <h2 class="section-title">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M9.669.864L8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68L9.669.864zm1.196 1.193l.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702 1.509.229z"/>
                    <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                </svg>
                Sistem Penilaian / Scoring System
            </h2>
            
            <div class="scoring-grid">
                <!-- Point System -->
                <div class="score-item">
                    <div class="score-label">Per Soal Benar</div>
                    <div class="score-value success">@pointPerQuestion pts</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Salah / False</div>
                    <div class="score-value error">0 pts</div>
                </div>
            </div>

            <div class="divider"></div>

            <!-- Grade System -->
            <div class="grade-system">
                <div class="grade-row">
                    <span class="grade-range">0-60</span>
                    <span class="grade-badge unsatisfactory">Kurang Memuaskan</span>
                </div>
                <div class="grade-row">
                    <span class="grade-range">61-79</span>
                    <span class="grade-badge satisfactory">Cukup Memuaskan</span>
                </div>
                <div class="grade-row">
                    <span class="grade-range">80-100</span>
                    <span class="grade-badge good">Memuaskan</span>
                </div>
            </div>

            <div class="divider"></div>

            <!-- Pass/Fail -->
            <div class="pass-fail">
                <div class="pf-item fail">
                    <span class="pf-icon">✕</span>
                    <span class="pf-text">Gagal: &lt; 80</span>
                </div>
                <div class="pf-item pass">
                    <span class="pf-icon">✓</span>
                    <span class="pf-text">Lulus: ≥ 80</span>
                </div>
            </div>
        </div>

        <!-- Employee Info - Compact -->
        <div class="section-card employee-card">
            <h2 class="section-title">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                </svg>
                Informasi Karyawan
            </h2>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Nama / Name</div>
                    <div class="info-value">@Model.EmployeeName</div>
                </div>
                <div class="info-item">
                    <div class="info-label">No. Karyawan</div>
                    <div class="info-value">@Model.EmployeeNumber</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Tanggal Training</div>
                    <div class="info-value">@Model.TrainingDate?.ToString("dd MMM yyyy")</div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-section">
            <a href="@Url.Action("Index", "User")" class="btn btn-secondary">
                <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                    <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
                </svg>
                Back to Menu
            </a>

            @switch ((QuizStatus)Enum.Parse(typeof(QuizStatus), status))
            {
                case QuizStatus.Blocked:
                    <div class="alert-box blocked">
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
                        </svg>
                        <span>Silakan hubungi trainer untuk mengambil kuis</span>
                    </div>
                    break;
                case QuizStatus.Start:
                    <button type="submit" class="btn btn-primary">
                        Mulai Quiz
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                        </svg>
                    </button>
                    break;
                case QuizStatus.Continue:
                    <button type="submit" class="btn btn-primary">
                        Lanjutkan Quiz
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                        </svg>
                    </button>
                    break;
                case QuizStatus.Second:
                    <button type="submit" class="btn btn-primary">
                        Quiz Kedua
                        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                            <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                        </svg>
                    </button>
                    break;
                case QuizStatus.Done:
                    <div class="alert-box success">
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                        </svg>
                        <span>Quiz telah selesai. Terima kasih!</span>
                    </div>
                    break;
            }
        </div>

        <input type="hidden" name="ParticipantId" value="@participantId" />
    }
</div>

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .mobile-container {
        max-width: 480px;
        margin: 0 auto;
        padding: 12px;
        background: #f5f5f5;
        min-height: 100vh;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    /* Header Card */
    .header-card {
        background: white;
        color: #1a1a1a;
        padding: 20px 16px;
        border-radius: 12px;
        margin-bottom: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        border: 1px solid #e5e7eb;
    }

    .title {
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 6px;
        line-height: 1.3;
    }

    .subtitle {
        font-size: 12px;
        color: #666;
        margin-bottom: 8px;
        font-weight: 500;
    }

    .meta-info {
        font-size: 11px;
        color: #666;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .separator {
        opacity: 0.6;
    }

    /* Section Cards */
    .section-card {
        background: white;
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.06);
        border: 1px solid #e5e7eb;
    }

    .section-title {
        font-size: 14px;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .section-title svg {
        color: #4f46e5;
        flex-shrink: 0;
    }

    /* Objectives */
    .objectives-list {
        list-style: none;
        counter-reset: obj-counter;
    }

    .objectives-list li {
        counter-increment: obj-counter;
        margin-bottom: 10px;
        position: relative;
        padding-left: 24px;
    }

    .objectives-list li:last-child {
        margin-bottom: 0;
    }

    .objectives-list li::before {
        content: counter(obj-counter);
        position: absolute;
        left: 0;
        top: 2px;
        width: 18px;
        height: 18px;
        background: #4f46e5;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 600;
    }

    .obj-id {
        font-size: 13px;
        color: #1a1a1a;
        line-height: 1.4;
        margin-bottom: 2px;
    }

    .obj-en {
        font-size: 12px;
        color: #666;
        line-height: 1.4;
        font-style: italic;
    }

    /* Scoring Card */
    .scoring-card {
        background: white;
    }

    .scoring-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 12px;
    }

    .score-item {
        background: white;
        padding: 12px;
        border-radius: 8px;
        text-align: center;
        border: 1px solid #e5e7eb;
    }

    .score-label {
        font-size: 11px;
        color: #666;
        margin-bottom: 6px;
    }

    .score-value {
        font-size: 20px;
        font-weight: 700;
    }

    .score-value.success {
        color: #10b981;
    }

    .score-value.error {
        color: #ef4444;
    }

    .divider {
        height: 1px;
        background: linear-gradient(to right, transparent, #e5e7eb, transparent);
        margin: 12px 0;
    }

    /* Grade System */
    .grade-system {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 12px;
    }

    .grade-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 12px;
    }

    .grade-range {
        font-weight: 600;
        color: #1a1a1a;
        min-width: 50px;
    }

    .grade-badge {
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 500;
    }

    .grade-badge.unsatisfactory {
        background: #fee2e2;
        color: #991b1b;
    }

    .grade-badge.satisfactory {
        background: #fef3c7;
        color: #92400e;
    }

    .grade-badge.good {
        background: #d1fae5;
        color: #065f46;
    }

    /* Pass/Fail */
    .pass-fail {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .pf-item {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 12px;
        font-weight: 500;
    }

    .pf-item.fail {
        background: #fee2e2;
        color: #991b1b;
    }

    .pf-item.pass {
        background: #d1fae5;
        color: #065f46;
    }

    .pf-icon {
        font-weight: 700;
        font-size: 14px;
    }

    /* Employee Info */
    .info-grid {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .info-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .info-label {
        font-size: 11px;
        color: #666;
        font-weight: 500;
    }

    .info-value {
        font-size: 13px;
        color: #1a1a1a;
        font-weight: 500;
    }

    /* Action Section */
    .action-section {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 16px;
    }

    .btn {
        padding: 14px 20px;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 600;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        text-decoration: none;
        transition: all 0.2s;
    }

    .btn-primary {
        background: #4f46e5;
        color: white;
        box-shadow: 0 4px 6px rgba(79, 70, 229, 0.3);
    }

    .btn-primary:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(79, 70, 229, 0.3);
        background: #4338ca;
    }

    .btn-secondary {
        background: white;
        color: #4f46e5;
        border: 2px solid #4f46e5;
    }

    .btn-secondary:active {
        background: #f8f9ff;
    }

    /* Alert Box */
    .alert-box {
        padding: 14px 16px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 13px;
        font-weight: 500;
        line-height: 1.4;
        border: 1px solid;
    }

    .alert-box.blocked {
        background: #fef3c7;
        color: #92400e;
        border-color: #fde68a;
    }

    .alert-box.success {
        background: #d1fae5;
        color: #065f46;
        border-color: #a7f3d0;
    }

    .alert-box svg {
        flex-shrink: 0;
    }
</style>